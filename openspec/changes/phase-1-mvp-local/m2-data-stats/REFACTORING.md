# M2 重构说明

## 重构日期
2026-01-17

## 重构原因
原设计将"数据总览"和"活跃日历"分为两个独立的标签页，用户反馈用途不清晰，需要频繁切换才能看到完整信息。

## 重构方案
采用**方案1：合并为一个统一的统计页面**

### 变更内容

#### 1. UI 结构变更
**之前**：
```
Options 页面
├── 标签导航（日历 / 总览）
├── 活跃日历页面
└── 数据总览页面（6个指标卡片）
```

**之后**：
```
Options 页面
└── 统计页面（StatsPage）
    ├── 关键指标区域（3个卡片）
    └── 活跃日历区域
```

#### 2. 关键指标精简
**之前（6个指标）**：
- 总功德值
- 总敲击次数
- 连续活跃天数
- 平均每日敲击
- 存活天数
- 最长连续活跃

**之后（3个指标）**：
- 🙏 总功德值
- 🔥 连续活跃天数
- 📅 存活天数

**精简理由**：
- 总敲击次数 = 总功德值（1:1对应，冗余）
- 平均每日敲击：计算值，不如直接看日历热力图直观
- 最长连续活跃：历史数据，激励作用不如当前连续天数

#### 3. 代码变更
**新增文件**：
- `src/options/components/StatsPage.tsx` - 统一的统计页面组件
- `src/options/components/StatsPage.css` - 统计页面样式

**修改文件**：
- `src/options/Options.tsx` - 移除标签导航，直接渲染 StatsPage
- `src/options/Options.css` - 移除导航相关样式

**保留但未使用的文件**（可选删除）：
- `src/options/components/Calendar.tsx`
- `src/options/components/Calendar.css`
- `src/options/components/DataOverview.tsx`
- `src/options/components/DataOverview.css`

## 优势

### 用户体验
1. **一屏展示**：无需切换标签，一眼看到所有关键数据
2. **信息层次清晰**：顶部概览（关键指标）+ 底部详情（日历）
3. **减少认知负担**：3个核心指标，避免信息过载
4. **操作更流畅**：移除标签切换，减少点击次数

### 技术实现
1. **代码更简洁**：减少组件数量和状态管理
2. **性能更好**：一次加载所有数据，无需重复请求
3. **维护更容易**：单一组件，逻辑集中

## 验收状态
- [x] 构建成功
- [x] TypeScript 类型检查通过
- [x] 关键指标显示正确
- [x] 日历热力图显示正确
- [x] 月份切换功能正常
- [x] 响应式设计适配移动端
- [ ] 实际使用测试（需要用户反馈）

## 后续优化建议
1. 可以添加"展开更多指标"功能，满足想看详细数据的用户
2. 可以添加点击日期查看详情的功能
3. M3 阶段可以增加趋势图表，提供更丰富的数据分析
