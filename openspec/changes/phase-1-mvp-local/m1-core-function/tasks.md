# M1ï¼šæ ¸å¿ƒåŠŸèƒ½ - ä»»åŠ¡æ¸…å•

## è¿­ä»£ 1.1ï¼šæœ€å°å¯ç”¨æœ¨é±¼ï¼ˆ0.5 å¤©ï¼‰âœ…

### æ•°æ®å±‚
- [x] 1.1.1 åˆ›å»ºåŸºç¡€ç±»å‹å®šä¹‰
  - åœ¨ `src/shared/types.ts` ä¸­å®šä¹‰ `UserData`ï¼ˆå®Œæ•´ç‰ˆï¼‰
  - åŒ…å«æ‰€æœ‰å¿…è¦å­—æ®µ
  
- [x] 1.1.2 å®ç°å­˜å‚¨ç®¡ç†
  - ç¡®è®¤ `src/shared/storage.ts` å·²å­˜åœ¨
  - æµ‹è¯• get/set æ–¹æ³•

- [x] 1.1.3 å®šä¹‰å­˜å‚¨é”®
  - åœ¨ `src/shared/constants.ts` ä¸­å®šä¹‰ `STORAGE_KEYS.USER_DATA`

### UI å±‚
- [x] 1.1.4 åˆ›å»º Popup åŸºç¡€é¡µé¢
  - æ›´æ–° `src/popup/Popup.tsx`
  - æ›´æ–° `src/popup/index.html`
  - è®¾ç½®åŸºç¡€å¸ƒå±€

- [x] 1.1.5 åˆ›å»ºæœ¨é±¼ç»„ä»¶
  - åˆ›å»º `src/popup/components/WoodenFish.tsx`
  - åˆ›å»º `src/popup/components/WoodenFish.css`
  - å®ç°æœ¨é±¼æŒ‰é’®ï¼ˆå›¾æ ‡ + æ–‡å­—ï¼‰
  - æ·»åŠ ç‚¹å‡»äº‹ä»¶

- [x] 1.1.6 æ˜¾ç¤ºç»Ÿè®¡æ•°æ®
  - åœ¨ Popup ä¸­æ˜¾ç¤º todayKnocks
  - åœ¨ Popup ä¸­æ˜¾ç¤º totalKnocks
  - åœ¨ Popup ä¸­æ˜¾ç¤º merit
  - æ ¼å¼åŒ–æ•°å­—æ˜¾ç¤º

### é€»è¾‘å±‚
- [x] 1.1.7 å®ç°ç‚¹å‡»å¤„ç†
  - åˆ›å»º `src/popup/hooks/useKnock.ts`
  - å®ç°ç‚¹å‡»æ—¶ totalKnocks +1
  - å®ç°ç‚¹å‡»æ—¶ todayKnocks +1
  - å®ç°ç‚¹å‡»æ—¶ merit +1
  - ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨

- [x] 1.1.8 å®ç°ç”¨æˆ·åˆå§‹åŒ–
  - åˆ›å»º `src/shared/utils/id-generator.ts`
  - å®ç° `generateUserId()`
  - å®ç° `generateRecordId()`
  - é¦–æ¬¡ä½¿ç”¨æ—¶åˆå§‹åŒ– UserData

### éªŒæ”¶
- [x] 1.1.9 æµ‹è¯•åŸºç¡€åŠŸèƒ½
  - æ„å»ºæˆåŠŸ
  - TypeScript ç±»å‹æ£€æŸ¥é€šè¿‡
  - æ— ç¼–è¯‘é”™è¯¯

---

## è¿­ä»£ 1.2ï¼šä»Šæ—¥æ•²å‡»ç»Ÿè®¡ï¼ˆ0.5 å¤©ï¼‰âœ…

### æ•°æ®å±‚
- [x] 1.2.1 æ‰©å±• UserData ç±»å‹
  - å·²åœ¨ `src/shared/types.ts` ä¸­åŒ…å« `todayKnocks` å’Œ `lastKnockTime`

### å·¥å…·å±‚
- [x] 1.2.2 å®ç°æ—¥æœŸå·¥å…·
  - åˆ›å»º `src/shared/utils/date.ts`
  - å®ç° `isSameDay(timestamp1, timestamp2)`
  - å®ç° `getStartOfDay(timestamp)`
  - å®ç° `getDaysDiff(timestamp1, timestamp2)`

### é€»è¾‘å±‚
- [x] 1.2.3 å®ç°è·¨å¤©æ£€æµ‹
  - åœ¨ useKnock ä¸­æ·»åŠ è·¨å¤©æ£€æµ‹
  - è·¨å¤©æ—¶é‡ç½® todayKnocks = 1
  - æ›´æ–° lastKnockTime

- [x] 1.2.4 æ›´æ–°æ•²å‡»é€»è¾‘
  - todayKnocks +1ï¼ˆåŒå¤©ï¼‰æˆ–é‡ç½®ä¸º 1ï¼ˆè·¨å¤©ï¼‰
  - totalKnocks +1
  - ä¿å­˜ lastKnockTime

### UI å±‚
- [x] 1.2.5 æ˜¾ç¤ºä»Šæ—¥æ•²å‡»
  - åœ¨ Popup ä¸­æ˜¾ç¤º todayKnocks
  - åŒºåˆ†ä»Šæ—¥å’Œæ€»è®¡æ˜¾ç¤º

### éªŒæ”¶
- [x] 1.2.6 æµ‹è¯•è·¨å¤©é€»è¾‘
  - TypeScript ç±»å‹æ£€æŸ¥é€šè¿‡
  - è·¨å¤©æ£€æµ‹é€»è¾‘å·²å®ç°

---

## è¿­ä»£ 1.3ï¼šåŠŸå¾·å€¼ç³»ç»Ÿï¼ˆ0.5 å¤©ï¼‰âœ…

### æ•°æ®å±‚
- [x] 1.3.1 æ‰©å±• UserData ç±»å‹
  - å·²åœ¨ `src/shared/types.ts` ä¸­åŒ…å« `merit`

- [x] 1.3.2 å®šä¹‰åŠŸå¾·å€¼é…ç½®
  - åœ¨ `src/shared/constants.ts` ä¸­å®šä¹‰ `MERIT_CONFIG`
  - PER_KNOCK = 1

### é€»è¾‘å±‚
- [x] 1.3.3 å®ç°åŠŸå¾·å€¼ç´¯ç§¯
  - åœ¨ useKnock ä¸­æ·»åŠ  merit +1
  - ä¿å­˜åŠŸå¾·å€¼

### UI å±‚
- [x] 1.3.4 æ˜¾ç¤ºåŠŸå¾·å€¼
  - åœ¨ Popup ä¸­æ˜¾ç¤º merit
  - æ·»åŠ å›¾æ ‡ ğŸ™
  - æ ¼å¼åŒ–æ•°å­—æ˜¾ç¤º

### éªŒæ”¶
- [x] 1.3.5 æµ‹è¯•åŠŸå¾·å€¼
  - åŠŸå¾·å€¼ç´¯ç§¯é€»è¾‘å·²å®ç°
  - UI æ˜¾ç¤ºæ­£å¸¸

---

## è¿­ä»£ 1.4ï¼šç”Ÿå‘½å€¼ç³»ç»Ÿï¼ˆ1 å¤©ï¼‰âœ…

### æ•°æ®å±‚
- [x] 1.4.1 æ‰©å±• UserData ç±»å‹
  - å·²åœ¨ `src/shared/types.ts` ä¸­åŒ…å« `hp` å’Œ `status`

- [x] 1.4.2 å®šä¹‰ HP é…ç½®
  - åœ¨ `src/shared/constants.ts` ä¸­å®šä¹‰ `HP_CONFIG`
  - åœ¨ `src/shared/constants.ts` ä¸­å®šä¹‰ `HP_THRESHOLDS`

### å·¥å…·å±‚
- [x] 1.4.3 å®ç° HP è®¡ç®—å·¥å…·
  - åˆ›å»º `src/shared/utils/hp-calculator.ts`
  - å®ç° `calculateCurrentHP(lastKnockTime, currentHP, now)`
  - å®ç° `calculateKnockReward(currentHP, isFirstKnockToday)`
  - å®ç° `getHPColor(hp)`
  - å®ç° `getHPStatus(hp)`

### é€»è¾‘å±‚
- [x] 1.4.4 å®ç° HP å¥–åŠ±é€»è¾‘
  - åœ¨ useKnock ä¸­æ£€æµ‹æ˜¯å¦é¦–æ¬¡æ•²å‡»
  - é¦–æ¬¡æ•²å‡»æ—¶ HP +10ï¼ˆä¸è¶…è¿‡ 100ï¼‰
  - æ›´æ–° status = 'alive'

- [x] 1.4.5 å®ç° HP åˆå§‹åŒ–
  - æ–°ç”¨æˆ·åˆå§‹ HP = 100
  - åˆå§‹ status = 'alive'
  - åŠ è½½æ—¶è®¡ç®—å®é™… HPï¼ˆè€ƒè™‘æ—¶é—´æƒ©ç½šï¼‰

### UI å±‚
- [x] 1.4.6 åˆ›å»º HPBar ç»„ä»¶
  - åˆ›å»º `src/popup/components/HPBar.tsx`
  - åˆ›å»º `src/popup/components/HPBar.css`
  - å®ç°è¿›åº¦æ¡
  - æ ¹æ® HP æ˜¾ç¤ºä¸åŒé¢œè‰²
  - æ˜¾ç¤º HP æ•°å€¼ï¼ˆ80/100ï¼‰

- [x] 1.4.7 åˆ›å»º StatusDisplay ç»„ä»¶
  - åˆ›å»º `src/popup/components/StatusDisplay.tsx`
  - åˆ›å»º `src/popup/components/StatusDisplay.css`
  - æ˜¾ç¤ºå­˜æ´»çŠ¶æ€ï¼ˆè¡¨æƒ… + æ–‡å­—ï¼‰
  - æ˜¾ç¤ºè¿ç»­å¤©æ•°

- [x] 1.4.8 é›†æˆåˆ° Popup
  - åœ¨ Popup ä¸­æ·»åŠ  StatusDisplay
  - åœ¨ Popup ä¸­æ·»åŠ  HPBar
  - è°ƒæ•´å¸ƒå±€

### éªŒæ”¶
- [x] 1.4.9 æµ‹è¯• HP ç³»ç»Ÿ
  - TypeScript ç±»å‹æ£€æŸ¥é€šè¿‡
  - æ„å»ºæˆåŠŸ
  - HP è®¡ç®—é€»è¾‘å·²å®ç°
  - UI ç»„ä»¶å·²åˆ›å»º

---

## è¿­ä»£ 1.5ï¼šè¿ç»­æ´»è·ƒå¤©æ•°ï¼ˆ0.5 å¤©ï¼‰âœ…

### æ•°æ®å±‚
- [x] 1.5.1 æ‰©å±• UserData ç±»å‹
  - å·²åœ¨ `src/shared/types.ts` ä¸­åŒ…å« `consecutiveDays`

### é€»è¾‘å±‚
- [x] 1.5.2 å®ç°è¿ç»­å¤©æ•°è®¡ç®—
  - åœ¨ `src/shared/utils/date.ts` ä¸­å®ç° `calculateConsecutiveDays`
  - è¿ç»­ï¼šdaysDiff === 1ï¼Œè¿”å› current + 1
  - æ–­æ´»ï¼šdaysDiff > 1ï¼Œè¿”å› 1
  - åŒå¤©ï¼šdaysDiff === 0ï¼Œè¿”å› current

- [x] 1.5.3 æ›´æ–°æ•²å‡»é€»è¾‘
  - åœ¨ useKnock ä¸­æ£€æµ‹è·¨å¤©
  - è·¨å¤©æ—¶è®¡ç®—è¿ç»­å¤©æ•°
  - ä¿å­˜è¿ç»­å¤©æ•°

### UI å±‚
- [x] 1.5.4 æ˜¾ç¤ºè¿ç»­å¤©æ•°
  - åœ¨ StatusDisplay ä¸­æ·»åŠ è¿ç»­å¤©æ•°
  - æ ¼å¼ï¼šè¿ç»­ X å¤©

### éªŒæ”¶
- [x] 1.5.5 æµ‹è¯•è¿ç»­å¤©æ•°
  - è¿ç»­å¤©æ•°è®¡ç®—é€»è¾‘å·²å®ç°
  - UI æ˜¾ç¤ºå·²å®Œæˆ

---

## è¿­ä»£ 1.6ï¼šçŠ¶æ€æ£€æµ‹å’Œé€šçŸ¥ï¼ˆ1 å¤©ï¼‰âœ…

### Background å±‚
- [x] 1.6.1 åˆ›å»º Background å…¥å£
  - åˆ›å»º `src/background/index.ts`
  - è®¾ç½®åŸºç¡€ç»“æ„

- [x] 1.6.2 åˆ›å»º StatusChecker æœåŠ¡
  - åˆ›å»º `src/background/services/status-checker.ts`
  - å®ç° `StatusChecker` ç±»
  - å®ç° `checkAndUpdate()` æ–¹æ³•
  - æ£€æŸ¥è·¨å¤©ï¼Œé‡ç½® todayKnocks
  - è®¡ç®—å½“å‰ HP
  - æ£€æµ‹æ­»äº¡çŠ¶æ€
  - æ£€æµ‹è­¦å‘ŠçŠ¶æ€
  - æ›´æ–° Badge

- [x] 1.6.3 åˆ›å»º NotificationService
  - åˆ›å»º `src/background/services/notification-service.ts`
  - å®ç° `NotificationService` ç±»
  - å®ç° `showDeathWarning(daysSinceKnock)` - æ­»äº¡é€šçŸ¥
  - å®ç° `showHPWarning(hp)` - HP è­¦å‘Šé€šçŸ¥
  - å®ç° `showFirstKnockToday(consecutiveDays, hp)` - é¦–æ¬¡æ•²å‡»é€šçŸ¥

- [x] 1.6.4 å®ç°å®šæ—¶ä»»åŠ¡
  - åˆ›å»º `src/background/handlers/alarm-handler.ts`
  - ç›‘å¬ `chrome.runtime.onInstalled` - åˆ›å»º alarm
  - ç›‘å¬ `chrome.alarms.onAlarm` - å¤„ç†æ£€æŸ¥
  - åˆ›å»ºæ¯å°æ—¶æ£€æŸ¥çš„ alarm

- [x] 1.6.5 å®ç°ç”Ÿå‘½å‘¨æœŸäº‹ä»¶
  - ç›‘å¬ `chrome.runtime.onStartup` - æµè§ˆå™¨å¯åŠ¨æ—¶æ£€æŸ¥
  - ç›‘å¬ `chrome.runtime.onInstalled` - æ’ä»¶å®‰è£…æ—¶åˆå§‹åŒ–

- [x] 1.6.6 å®ç° Badge æ›´æ–°
  - åœ¨ StatusChecker ä¸­å®ç° `updateBadge(hp)`
  - ä½¿ç”¨ `chrome.action.setBadgeText` æ˜¾ç¤º HP æ•°å€¼
  - ä½¿ç”¨ `chrome.action.setBadgeBackgroundColor` è®¾ç½®é¢œè‰²

### é€šçŸ¥å±‚
- [x] 1.6.7 å®šä¹‰é€šçŸ¥é…ç½®
  - åœ¨ `src/shared/constants.ts` ä¸­å®šä¹‰ `NOTIFICATION_CONFIG`
  - DEATH_WARNING: title, icon
  - HP_WARNING: title, icon
  - FIRST_KNOCK_TODAY: title, icon

- [x] 1.6.8 å®ç°é€šçŸ¥æ–‡æ¡ˆ
  - æ­»äº¡é€šçŸ¥ï¼šğŸ’€ ä½ å·²å¾€ç”Ÿ
  - è­¦å‘Šé€šçŸ¥ï¼šâš ï¸ ç”Ÿå‘½å€¼å‘Šæ€¥
  - é¦–æ¬¡æ•²å‡»ï¼šğŸ™ åŠŸå¾· +1

### é›†æˆ
- [x] 1.6.9 é›†æˆåˆ°æ•²å‡»é€»è¾‘
  - åœ¨ useKnock ä¸­å‘é€æ¶ˆæ¯åˆ° background
  - Background æ›´æ–° Badge

- [x] 1.6.10 æ›´æ–° manifest.json
  - ç¡®è®¤ permissions åŒ…å« notifications, alarms
  - ç¡®è®¤ background.service_worker é…ç½®æ­£ç¡®

### éªŒæ”¶
- [x] 1.6.11 æµ‹è¯•çŠ¶æ€æ£€æµ‹
  - æ¯å°æ—¶è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€
  - æµè§ˆå™¨å¯åŠ¨æ—¶æ£€æŸ¥çŠ¶æ€
  - æ’ä»¶å®‰è£…æ—¶åˆå§‹åŒ–æ•°æ®

- [x] 1.6.12 æµ‹è¯•é€šçŸ¥
  - HP = 0 æ—¶æ˜¾ç¤ºæ­»äº¡é€šçŸ¥
  - HP < 30 æ—¶æ˜¾ç¤ºè­¦å‘Šé€šçŸ¥
  - ä»Šæ—¥é¦–æ¬¡æ•²å‡»æ˜¾ç¤ºé€šçŸ¥

- [x] 1.6.13 æµ‹è¯• Badge
  - Badge æ˜¾ç¤ºå½“å‰ HP
  - Badge é¢œè‰²æ ¹æ® HP å˜åŒ–

---

## å®Œæˆæ ‡å‡†

### å¿…é¡»å®Œæˆ
- [x] æ‰€æœ‰è¿­ä»£ä»»åŠ¡å®Œæˆ
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] æ—  Console é”™è¯¯
- [ ] æ•°æ®æŒä¹…åŒ–æ­£å¸¸

### éªŒæ”¶æ£€æŸ¥
- [x] å¯ä»¥ç‚¹å‡»æœ¨é±¼
- [x] åŠŸå¾·å€¼æ­£ç¡®ç´¯ç§¯
- [x] ä»Šæ—¥/æ€»æ•²å‡»ç»Ÿè®¡æ­£ç¡®
- [x] HP ç³»ç»Ÿæ­£å¸¸å·¥ä½œ
- [x] è¿ç»­å¤©æ•°æ­£ç¡®è®¡ç®—
- [ ] é€šçŸ¥æ­£å¸¸æ˜¾ç¤º
- [ ] Badge æ­£å¸¸æ›´æ–°

## æ—¶é—´å®‰æ’

**Day 1ï¼š**
- ä¸Šåˆï¼šè¿­ä»£ 1.1ï¼ˆæœ€å°å¯ç”¨æœ¨é±¼ï¼‰
- ä¸‹åˆï¼šè¿­ä»£ 1.2ï¼ˆä»Šæ—¥æ•²å‡»ç»Ÿè®¡ï¼‰+ è¿­ä»£ 1.3ï¼ˆåŠŸå¾·å€¼ç³»ç»Ÿï¼‰

**Day 2ï¼š**
- å…¨å¤©ï¼šè¿­ä»£ 1.4ï¼ˆç”Ÿå‘½å€¼ç³»ç»Ÿï¼‰

**Day 3ï¼š**
- ä¸Šåˆï¼šè¿­ä»£ 1.5ï¼ˆè¿ç»­æ´»è·ƒå¤©æ•°ï¼‰
- ä¸‹åˆï¼šè¿­ä»£ 1.6ï¼ˆçŠ¶æ€æ£€æµ‹å’Œé€šçŸ¥ï¼‰- å¼€å§‹

**Day 4ï¼š**
- å…¨å¤©ï¼šè¿­ä»£ 1.6ï¼ˆçŠ¶æ€æ£€æµ‹å’Œé€šçŸ¥ï¼‰- å®Œæˆ + æµ‹è¯•

## æ³¨æ„äº‹é¡¹

1. **å¢é‡å¼€å‘**ï¼šæ¯å®Œæˆä¸€ä¸ªè¿­ä»£ç«‹å³æµ‹è¯•
2. **æ•°æ®å…¼å®¹**ï¼šæ¯æ¬¡æ‰©å±• UserData æ—¶æ³¨æ„å…¼å®¹æ€§
3. **ç±»å‹å®‰å…¨**ï¼šç¡®ä¿ TypeScript ç±»å‹æ£€æŸ¥é€šè¿‡
4. **é”™è¯¯å¤„ç†**ï¼šæ·»åŠ é€‚å½“çš„ try-catch
5. **æ—¥å¿—è¾“å‡º**ï¼šä½¿ç”¨ç»Ÿä¸€çš„æ—¥å¿—å‰ç¼€ `[AliveChecker]`

## ä¸‹ä¸€æ­¥

å®Œæˆ M1 åï¼š
1. æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
2. ä¿®å¤å‘ç°çš„ bug
3. å‡†å¤‡è¿›å…¥ M2ï¼šæ•°æ®ç»Ÿè®¡
