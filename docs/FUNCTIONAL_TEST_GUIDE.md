# 功能测试指南 / Functional Test Guide

**版本**: v1.0.0  
**更新时间**: 2026-01-22  
**测试范围**: M1-M7 已实现功能

---

## 📋 测试概述

本文档提供完整的功能测试清单，用于验证"还活着吗"Chrome 扩展的所有已实现功能。

### 测试环境要求

- Chrome 浏览器 88+ 或 Edge 88+
- 已安装扩展（开发模式）
- 网络连接（用于测试云端同步功能）
- Firebase 项目已配置（用于测试认证和同步）

### 测试数据准备

建议在测试前清空本地数据：
```javascript
// 在浏览器控制台执行
chrome.storage.local.clear();
```

---

## 🎯 测试清单总览

| 模块 | 功能数 | 优先级 | 状态 |
|------|--------|--------|------|
| M1: 敲木鱼核心功能 | 8 | P0 | ✅ |
| M2: 功德值系统 | 7 | P0 | ✅ |
| M3: 生命值系统 | 6 | P0 | ✅ |
| M4: 数据可视化 | 5 | P1 | ✅ |
| M5: 死亡通知系统 | 6 | P1 | ✅ |
| M6: 国际化 | 4 | P1 | ✅ |
| M7: 认证与同步 | 10 | P1 | 🚧 |

**优先级说明**:
- P0: 核心功能，必须通过
- P1: 重要功能，建议通过
- P2: 增强功能，可选通过

---

## 📦 M1: 敲木鱼核心功能测试

### 测试目标
验证敲木鱼的基础交互和动画效果。

### 测试用例

#### TC-M1-001: 木鱼显示
**优先级**: P0  
**前置条件**: 打开 Popup 页面

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 点击扩展图标打开 Popup | Popup 页面正常打开 | | ⬜ |
| 2 | 观察木鱼显示 | 木鱼图标居中显示，俯视视角 | | ⬜ |
| 3 | 观察木鱼样式 | 木鱼有圆形边框，禅意设计 | | ⬜ |

#### TC-M1-002: 点击敲击
**优先级**: P0  
**前置条件**: Popup 页面已打开

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 点击木鱼 | 木鱼有点击反馈 | | ⬜ |
| 2 | 观察动画 | 木鱼缩小后恢复 | | ⬜ |
| 3 | 观察声波 | 出现声波扩散动画 | | ⬜ |
| 4 | 观察数据 | 今日敲击次数 +1 | | ⬜ |

#### TC-M1-003: 连续敲击
**优先级**: P0  
**前置条件**: Popup 页面已打开

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 快速连续点击木鱼 5 次 | 每次点击都有响应 | | ⬜ |
| 2 | 观察动画 | 动画不卡顿，流畅播放 | | ⬜ |
| 3 | 观察数据 | 今日敲击次数增加 5 | | ⬜ |

#### TC-M1-004: 鼠标悬停效果
**优先级**: P1  
**前置条件**: Popup 页面已打开

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 鼠标悬停在木鱼上 | 木鱼有呼吸动画效果 | | ⬜ |
| 2 | 鼠标移开 | 呼吸动画停止 | | ⬜ |

#### TC-M1-005: 冲击波效果
**优先级**: P1  
**前置条件**: Popup 页面已打开

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 点击木鱼 | 出现冲击波扩散动画 | | ⬜ |
| 2 | 观察冲击波 | 冲击波从中心向外扩散 | | ⬜ |
| 3 | 观察消失 | 冲击波逐渐淡出消失 | | ⬜ |

#### TC-M1-006: 无限次敲击
**优先级**: P0  
**前置条件**: Popup 页面已打开

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 连续敲击 100 次 | 所有敲击都被记录 | | ⬜ |
| 2 | 观察性能 | 页面不卡顿，响应流畅 | | ⬜ |
| 3 | 检查数据 | 今日敲击次数 = 100 | | ⬜ |

#### TC-M1-007: 数据持久化
**优先级**: P0  
**前置条件**: 已敲击若干次

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 记录当前敲击次数 | 例如：10 次 | | ⬜ |
| 2 | 关闭 Popup | Popup 关闭 | | ⬜ |
| 3 | 重新打开 Popup | 敲击次数保持为 10 | | ⬜ |
| 4 | 重启浏览器 | 数据仍然保持 | | ⬜ |

#### TC-M1-008: 跨日重置
**优先级**: P0  
**前置条件**: 今日已敲击若干次

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 记录今日敲击次数 | 例如：15 次 | | ⬜ |
| 2 | 修改系统时间到明天 | 时间改变 | | ⬜ |
| 3 | 重新打开 Popup | 今日敲击次数重置为 0 | | ⬜ |
| 4 | 检查总计敲击 | 总计保持为 15 | | ⬜ |

---

## 🙏 M2: 功德值系统测试

### 测试目标
验证功德值的多维度计算算法。

### 功德值计算规则
- 基础功德：每次 +1
- 每日首次：+5
- 连击加成：3秒内连续敲击，每次额外 +1（最多 +5）
- 连续天数：每连续一天 +0.5（最多 +10）
- 里程碑：10次(+10)、50次(+50)、100次(+100)、500次(+500)、1000次(+1000)、5000次(+5000)

### 测试用例

#### TC-M2-001: 基础功德
**优先级**: P0  
**前置条件**: 清空数据，首次使用

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 敲击木鱼 1 次 | 功德值 = 6 (1基础+5首次) | | ⬜ |
| 2 | 再敲击 1 次 | 功德值 = 7 (累计) | | ⬜ |
| 3 | 再敲击 1 次 | 功德值 = 8 (累计) | | ⬜ |

#### TC-M2-002: 每日首次加成
**优先级**: P0  
**前置条件**: 今日未敲击

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 记录当前功德值 | 例如：100 | | ⬜ |
| 2 | 敲击木鱼 1 次 | 功德值 = 106 (+6) | | ⬜ |
| 3 | 再敲击 1 次 | 功德值 = 107 (+1) | | ⬜ |

#### TC-M2-003: 连击加成
**优先级**: P0  
**前置条件**: Popup 页面已打开

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 记录当前功德值 | 例如：10 | | ⬜ |
| 2 | 在 3 秒内连续敲击 3 次 | 功德值增加 (1+1+2+3) = 7 | | ⬜ |
| 3 | 等待 5 秒后再敲击 | 连击重置，只增加 1 | | ⬜ |

#### TC-M2-004: 最大连击加成
**优先级**: P1  
**前置条件**: Popup 页面已打开

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 记录当前功德值 | 例如：20 | | ⬜ |
| 2 | 快速连续敲击 10 次 | 连击加成最多 +5 | | ⬜ |
| 3 | 计算总增加 | 应为 10 + 连击加成(1+2+3+4+5+5+5+5+5+5) = 50 | | ⬜ |

#### TC-M2-005: 里程碑奖励 - 10次
**优先级**: P0  
**前置条件**: 总敲击次数 = 9

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 记录当前功德值 | 例如：15 | | ⬜ |
| 2 | 敲击 1 次（达到 10 次） | 功德值增加 1 + 10(里程碑) = 11 | | ⬜ |
| 3 | 观察提示 | 显示里程碑达成提示 | | ⬜ |

#### TC-M2-006: 里程碑奖励 - 100次
**优先级**: P1  
**前置条件**: 总敲击次数 = 99

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 记录当前功德值 | 例如：150 | | ⬜ |
| 2 | 敲击 1 次（达到 100 次） | 功德值增加 1 + 100(里程碑) = 101 | | ⬜ |
| 3 | 观察提示 | 显示里程碑达成提示 | | ⬜ |

#### TC-M2-007: 功德等级显示
**优先级**: P1  
**前置条件**: 可以修改功德值测试

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 功德值 < 10 | 显示"新手" | | ⬜ |
| 2 | 功德值 = 50 | 显示"初学者" | | ⬜ |
| 3 | 功德值 = 200 | 显示"初窥门径" | | ⬜ |
| 4 | 功德值 = 600 | 显示"虔诚信徒" | | ⬜ |
| 5 | 功德值 = 2000 | 显示"修行有成" | | ⬜ |
| 6 | 功德值 = 6000 | 显示"大德高僧" | | ⬜ |
| 7 | 功德值 = 10000 | 显示"功德圆满" | | ⬜ |

---

## 💯 M3: 生命值系统测试

### 测试目标
验证 HP 系统的计算和状态显示。

### HP 计算规则
- 初始值：100 HP
- 每日首次敲击：+10 HP（最大 100）
- 每天不敲击：-10 HP（最小 0）
- 状态：HP > 0 为"存活"，HP = 0 为"往生"

### 测试用例

#### TC-M3-001: 初始 HP
**优先级**: P0  
**前置条件**: 清空数据，首次使用

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Popup | HP 显示为 100 | | ⬜ |
| 2 | 观察状态 | 显示"😊 存活中" | | ⬜ |
| 3 | 观察进度条 | 进度条为绿色，100% | | ⬜ |

#### TC-M3-002: 每日首次敲击奖励
**优先级**: P0  
**前置条件**: 今日未敲击，当前 HP = 50

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 敲击木鱼 1 次 | HP 增加到 60 (+10) | | ⬜ |
| 2 | 再敲击 1 次 | HP 保持 60（不再增加） | | ⬜ |
| 3 | 观察进度条 | 进度条颜色为黄色（警告） | | ⬜ |

#### TC-M3-003: HP 上限
**优先级**: P0  
**前置条件**: 当前 HP = 95

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 今日首次敲击 | HP 增加到 100（不超过上限） | | ⬜ |
| 2 | 观察进度条 | 进度条为绿色，100% | | ⬜ |

#### TC-M3-004: 每日惩罚
**优先级**: P0  
**前置条件**: 当前 HP = 100，今日已敲击

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 修改系统时间到明天 | 时间改变 | | ⬜ |
| 2 | 打开 Popup（不敲击） | HP 减少到 90 (-10) | | ⬜ |
| 3 | 再修改时间到后天 | 时间改变 | | ⬜ |
| 4 | 打开 Popup（不敲击） | HP 减少到 80 (-10) | | ⬜ |

#### TC-M3-005: HP 归零（往生）
**优先级**: P0  
**前置条件**: 当前 HP = 10

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 修改系统时间到明天 | 时间改变 | | ⬜ |
| 2 | 打开 Popup（不敲击） | HP 减少到 0 | | ⬜ |
| 3 | 观察状态 | 显示"💀 已往生" | | ⬜ |
| 4 | 观察进度条 | 进度条为红色，0% | | ⬜ |

#### TC-M3-006: 从往生恢复
**优先级**: P0  
**前置条件**: 当前 HP = 0（已往生）

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 敲击木鱼 1 次 | HP 增加到 10 | | ⬜ |
| 2 | 观察状态 | 显示"😊 存活中" | | ⬜ |
| 3 | 观察进度条 | 进度条为红色（危险），10% | | ⬜ |

#### TC-M3-007: HP 颜色状态
**优先级**: P1  
**前置条件**: 可以修改 HP 测试

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | HP = 80 | 进度条为绿色（健康） | | ⬜ |
| 2 | HP = 50 | 进度条为黄色（警告） | | ⬜ |
| 3 | HP = 20 | 进度条为红色（危险） | | ⬜ |

#### TC-M3-008: 连续天数统计
**优先级**: P0  
**前置条件**: 清空数据

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 今日首次敲击 | 连续天数 = 1 🔥 | | ⬜ |
| 2 | 修改时间到明天，敲击 | 连续天数 = 2 🔥 | | ⬜ |
| 3 | 修改时间到后天，敲击 | 连续天数 = 3 🔥 | | ⬜ |
| 4 | 修改时间到大后天（不敲击） | 连续天数重置为 0 | | ⬜ |

---

## 📊 M4: 数据可视化测试

### 测试目标
验证数据统计和显示的准确性。

### 测试用例

#### TC-M4-001: 今日敲击统计
**优先级**: P0  
**前置条件**: 今日未敲击

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Popup | 今日敲击显示 0 | | ⬜ |
| 2 | 敲击 5 次 | 今日敲击显示 5 | | ⬜ |
| 3 | 关闭并重新打开 | 今日敲击仍为 5 | | ⬜ |

#### TC-M4-002: 总计敲击统计
**优先级**: P0  
**前置条件**: 总敲击 = 50

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Popup | 总计敲击显示 50 | | ⬜ |
| 2 | 敲击 10 次 | 总计敲击显示 60 | | ⬜ |
| 3 | 修改时间到明天 | 总计敲击仍为 60 | | ⬜ |

#### TC-M4-003: 功德值显示
**优先级**: P0  
**前置条件**: 功德值 = 100

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Popup | 功德值显示 100 | | ⬜ |
| 2 | 敲击 1 次 | 功德值增加（根据算法） | | ⬜ |
| 3 | 观察格式 | 数字格式正确（千位分隔符） | | ⬜ |

#### TC-M4-004: HP 进度条
**优先级**: P1  
**前置条件**: HP = 75

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Popup | 进度条显示 75% | | ⬜ |
| 2 | 观察颜色 | 进度条为绿色 | | ⬜ |
| 3 | 观察动画 | 进度条有平滑过渡动画 | | ⬜ |

#### TC-M4-005: 数据实时更新
**优先级**: P0  
**前置条件**: Popup 页面已打开

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 记录当前数据 | 例如：今日 5，总计 50，功德 100 | | ⬜ |
| 2 | 敲击木鱼 | 所有数据立即更新 | | ⬜ |
| 3 | 观察延迟 | 更新无明显延迟（< 100ms） | | ⬜ |

---

## 📧 M5: 死亡通知系统测试

### 测试目标
验证紧急联系人管理和邮件预览功能。

### 测试用例

#### TC-M5-001: 添加紧急联系人
**优先级**: P0  
**前置条件**: 打开 Options 页面 - 联系人标签

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 点击"添加联系人"按钮 | 显示添加表单 | | ⬜ |
| 2 | 填写姓名"张三" | 输入成功 | | ⬜ |
| 3 | 填写邮箱"test@example.com" | 输入成功 | | ⬜ |
| 4 | 选择关系"家人" | 选择成功 | | ⬜ |
| 5 | 设置优先级 1 | 设置成功 | | ⬜ |
| 6 | 点击"保存" | 联系人添加成功，显示在列表中 | | ⬜ |

#### TC-M5-002: 邮箱格式验证
**优先级**: P0  
**前置条件**: 添加联系人表单已打开

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 输入无效邮箱"test" | 显示错误提示 | | ⬜ |
| 2 | 输入无效邮箱"test@" | 显示错误提示 | | ⬜ |
| 3 | 输入有效邮箱"test@example.com" | 验证通过 | | ⬜ |

#### TC-M5-003: 编辑联系人
**优先级**: P0  
**前置条件**: 已有联系人"张三"

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 点击联系人卡片的"编辑"按钮 | 显示编辑表单，数据已填充 | | ⬜ |
| 2 | 修改姓名为"李四" | 修改成功 | | ⬜ |
| 3 | 点击"保存" | 联系人更新成功 | | ⬜ |
| 4 | 观察列表 | 显示更新后的姓名"李四" | | ⬜ |

#### TC-M5-004: 删除联系人
**优先级**: P0  
**前置条件**: 已有联系人"张三"

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 点击联系人卡片的"删除"按钮 | 显示确认对话框 | | ⬜ |
| 2 | 点击"取消" | 联系人未删除 | | ⬜ |
| 3 | 再次点击"删除" | 显示确认对话框 | | ⬜ |
| 4 | 点击"确认" | 联系人删除成功，从列表中移除 | | ⬜ |

#### TC-M5-005: 邮件预览
**优先级**: P1  
**前置条件**: 已有联系人，打开邮件预览

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 点击"预览邮件"按钮 | 显示邮件预览对话框 | | ⬜ |
| 2 | 观察邮件内容 | 包含用户名、未活跃天数等信息 | | ⬜ |
| 3 | 观察样式 | 邮件样式美观，格式正确 | | ⬜ |
| 4 | 点击"关闭" | 预览对话框关闭 | | ⬜ |

#### TC-M5-006: 联系人优先级排序
**优先级**: P1  
**前置条件**: 已有多个联系人

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 添加联系人 A，优先级 3 | 添加成功 | | ⬜ |
| 2 | 添加联系人 B，优先级 1 | 添加成功 | | ⬜ |
| 3 | 添加联系人 C，优先级 2 | 添加成功 | | ⬜ |
| 4 | 观察列表顺序 | 按优先级排序：B(1) > C(2) > A(3) | | ⬜ |

---

## 🌍 M6: 国际化测试

### 测试目标
验证中英文双语切换功能。

### 测试用例

#### TC-M6-001: 默认语言
**优先级**: P0  
**前置条件**: 清空数据，首次使用

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Popup | 显示英文界面（默认） | | ⬜ |
| 2 | 观察文本 | 所有文本为英文 | | ⬜ |

#### TC-M6-002: 切换到中文
**优先级**: P0  
**前置条件**: 当前语言为英文

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Options 页面 | 页面打开 | | ⬜ |
| 2 | 点击"设置"标签 | 显示设置页面 | | ⬜ |
| 3 | 在语言选择器中选择"中文" | 语言切换成功 | | ⬜ |
| 4 | 观察界面 | 所有文本变为中文 | | ⬜ |
| 5 | 打开 Popup | Popup 也显示中文 | | ⬜ |

#### TC-M6-003: 切换到英文
**优先级**: P0  
**前置条件**: 当前语言为中文

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Options 页面 | 页面打开 | | ⬜ |
| 2 | 点击"设置"标签 | 显示设置页面 | | ⬜ |
| 3 | 在语言选择器中选择"English" | 语言切换成功 | | ⬜ |
| 4 | 观察界面 | 所有文本变为英文 | | ⬜ |

#### TC-M6-004: 语言持久化
**优先级**: P0  
**前置条件**: 已切换到中文

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 关闭所有扩展页面 | 页面关闭 | | ⬜ |
| 2 | 重新打开 Popup | 仍显示中文 | | ⬜ |
| 3 | 重启浏览器 | 浏览器重启 | | ⬜ |
| 4 | 打开 Popup | 仍显示中文 | | ⬜ |

#### TC-M6-005: 翻译完整性
**优先级**: P1  
**前置条件**: 无

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 切换到中文 | 所有界面元素都有中文翻译 | | ⬜ |
| 2 | 检查 Popup 页面 | 无英文残留 | | ⬜ |
| 3 | 检查 Options 页面 | 无英文残留 | | ⬜ |
| 4 | 检查所有标签页 | 无英文残留 | | ⬜ |
| 5 | 切换到英文 | 所有界面元素都有英文翻译 | | ⬜ |

---

## 🔐 M7: 用户认证与云端同步测试

### 测试目标
验证 Google 登录和数据云端同步功能。

### 前置条件
- Firebase 项目已配置
- Firestore Security Rules 已设置
- 网络连接正常

### 测试用例

#### TC-M7-001: Google 登录
**优先级**: P0  
**前置条件**: 未登录状态

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Popup | 显示"使用 Google 登录"按钮 | | ⬜ |
| 2 | 点击登录按钮 | 打开 Google 登录窗口 | | ⬜ |
| 3 | 选择 Google 账号 | 账号选择成功 | | ⬜ |
| 4 | 授权应用 | 授权成功 | | ⬜ |
| 5 | 观察界面 | 显示用户信息（头像、名称、邮箱） | | ⬜ |

#### TC-M7-002: 登录状态持久化
**优先级**: P0  
**前置条件**: 已登录

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 关闭 Popup | 页面关闭 | | ⬜ |
| 2 | 重新打开 Popup | 仍显示已登录状态 | | ⬜ |
| 3 | 重启浏览器 | 浏览器重启 | | ⬜ |
| 4 | 打开 Popup | 仍显示已登录状态 | | ⬜ |

#### TC-M7-003: 首次登录数据迁移
**优先级**: P0  
**前置条件**: 本地有数据（敲击 50 次，功德 100），未登录

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 记录本地数据 | 敲击 50，功德 100 | | ⬜ |
| 2 | 登录 Google 账号 | 登录成功 | | ⬜ |
| 3 | 等待数据迁移 | 显示迁移成功提示 | | ⬜ |
| 4 | 检查 Firestore | 云端有相同数据 | | ⬜ |

#### TC-M7-004: 数据上传同步
**优先级**: P0  
**前置条件**: 已登录

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 记录当前数据 | 例如：敲击 50 | | ⬜ |
| 2 | 敲击木鱼 10 次 | 本地数据更新为 60 | | ⬜ |
| 3 | 等待 5 秒 | 数据自动同步 | | ⬜ |
| 4 | 检查 Firestore | 云端数据也为 60 | | ⬜ |

#### TC-M7-005: 数据下载同步
**优先级**: P0  
**前置条件**: 已登录，设备 A 和设备 B

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 在设备 A 敲击 10 次 | 设备 A 数据更新 | | ⬜ |
| 2 | 等待同步完成 | 云端数据更新 | | ⬜ |
| 3 | 在设备 B 登录同一账号 | 登录成功 | | ⬜ |
| 4 | 观察设备 B 数据 | 数据与设备 A 一致 | | ⬜ |

#### TC-M7-006: 离线模式
**优先级**: P0  
**前置条件**: 已登录，网络连接正常

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 断开网络连接 | 网络断开 | | ⬜ |
| 2 | 敲击木鱼 5 次 | 本地数据正常更新 | | ⬜ |
| 3 | 观察同步状态 | 显示"离线"状态 | | ⬜ |
| 4 | 恢复网络连接 | 网络恢复 | | ⬜ |
| 5 | 等待自动同步 | 数据自动上传到云端 | | ⬜ |

#### TC-M7-007: 手动同步
**优先级**: P1  
**前置条件**: 已登录

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Options - 账号设置 | 页面打开 | | ⬜ |
| 2 | 观察最后同步时间 | 显示时间戳 | | ⬜ |
| 3 | 点击"立即同步"按钮 | 显示同步中状态 | | ⬜ |
| 4 | 等待同步完成 | 显示同步成功，时间更新 | | ⬜ |

#### TC-M7-008: 添加联系人时登录提示
**优先级**: P0  
**前置条件**: 未登录

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Options - 联系人 | 页面打开 | | ⬜ |
| 2 | 点击"添加联系人" | 显示登录提示对话框 | | ⬜ |
| 3 | 观察提示内容 | 说明登录的好处 | | ⬜ |
| 4 | 点击"稍后再说" | 对话框关闭，可以继续添加 | | ⬜ |
| 5 | 填写联系人信息并保存 | 联系人保存成功（仅本地） | | ⬜ |

#### TC-M7-009: 退出登录
**优先级**: P0  
**前置条件**: 已登录

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Options - 账号设置 | 页面打开 | | ⬜ |
| 2 | 点击"退出登录"按钮 | 显示确认对话框 | | ⬜ |
| 3 | 点击"确认" | 退出成功 | | ⬜ |
| 4 | 观察界面 | 显示未登录状态 | | ⬜ |
| 5 | 检查本地数据 | 本地数据保留 | | ⬜ |

#### TC-M7-010: 邮件模板同步
**优先级**: P1  
**前置条件**: 已登录

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 首次登录 | 登录成功 | | ⬜ |
| 2 | 检查 Firestore | userSettings 集合存在 | | ⬜ |
| 3 | 检查 emailTemplate 字段 | 包含完整的邮件模板 | | ⬜ |
| 4 | 检查模板内容 | 包含 subject、htmlBody、textBody | | ⬜ |

---

## 🔧 集成测试场景

### 场景 1: 新用户完整流程
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 安装扩展 | 安装成功 | | ⬜ |
| 2 | 首次打开 Popup | 显示初始状态（HP=100，功德=0） | | ⬜ |
| 3 | 敲击木鱼 1 次 | 今日敲击=1，功德=6，HP=100 | | ⬜ |
| 4 | 连续敲击 9 次 | 达到 10 次里程碑，获得奖励 | | ⬜ |
| 5 | 打开 Options | 所有标签页正常显示 | | ⬜ |
| 6 | 添加紧急联系人 | 显示登录提示 | | ⬜ |
| 7 | 点击"稍后再说" | 可以继续添加联系人 | | ⬜ |
| 8 | 保存联系人 | 联系人保存成功 | | ⬜ |
| 9 | 切换语言到中文 | 界面变为中文 | | ⬜ |
| 10 | 关闭并重新打开 | 所有数据和设置保持 | | ⬜ |

### 场景 2: 连续打卡流程
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 第 1 天敲击 | 连续天数=1，HP=100 | | ⬜ |
| 2 | 第 2 天敲击 | 连续天数=2，HP=100 | | ⬜ |
| 3 | 第 3 天敲击 | 连续天数=3，HP=100 | | ⬜ |
| 4 | 第 4 天不敲击 | 连续天数=0，HP=90 | | ⬜ |
| 5 | 第 5 天敲击 | 连续天数=1，HP=100 | | ⬜ |

### 场景 3: 云端同步流程
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 本地敲击 50 次 | 本地数据：敲击=50 | | ⬜ |
| 2 | 登录 Google 账号 | 登录成功，数据迁移 | | ⬜ |
| 3 | 检查 Firestore | 云端数据：敲击=50 | | ⬜ |
| 4 | 在设备 A 敲击 10 次 | 设备 A：敲击=60 | | ⬜ |
| 5 | 在设备 B 登录 | 设备 B：敲击=60 | | ⬜ |
| 6 | 在设备 B 敲击 5 次 | 设备 B：敲击=65 | | ⬜ |
| 7 | 在设备 A 刷新 | 设备 A：敲击=65 | | ⬜ |
## 🔧 集成测试场景

### 场景 1: 新用户完整流程
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 安装扩展 | 安装成功 | | ⬜ |
| 2 | 首次打开 Popup | 显示初始状态（HP=100，功德=0） | | ⬜ |
| 3 | 敲击木鱼 1 次 | 今日敲击=1，功德=6，HP=100 | | ⬜ |
| 4 | 连续敲击 9 次 | 达到 10 次里程碑，获得奖励 | | ⬜ |
| 5 | 打开 Options | 所有标签页正常显示 | | ⬜ |
| 6 | 添加紧急联系人 | 显示登录提示 | | ⬜ |
| 7 | 点击"稍后再说" | 可以继续添加联系人 | | ⬜ |
| 8 | 保存联系人 | 联系人保存成功 | | ⬜ |
| 9 | 切换语言到中文 | 界面变为中文 | | ⬜ |
| 10 | 关闭并重新打开 | 所有数据和设置保持 | | ⬜ |

### 场景 2: 连续打卡流程
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 第 1 天敲击 | 连续天数=1，HP=100 | | ⬜ |
| 2 | 第 2 天敲击 | 连续天数=2，HP=100 | | ⬜ |
| 3 | 第 3 天敲击 | 连续天数=3，HP=100 | | ⬜ |
| 4 | 第 4 天不敲击 | 连续天数=0，HP=90 | | ⬜ |
| 5 | 第 5 天敲击 | 连续天数=1，HP=100 | | ⬜ |

### 场景 3: 云端同步流程
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 本地敲击 50 次 | 本地数据：敲击=50 | | ⬜ |
| 2 | 登录 Google 账号 | 登录成功，数据迁移 | | ⬜ |
| 3 | 检查 Firestore | 云端数据：敲击=50 | | ⬜ |
| 4 | 在设备 A 敲击 10 次 | 设备 A：敲击=60 | | ⬜ |
| 5 | 在设备 B 登录 | 设备 B：敲击=60 | | ⬜ |
| 6 | 在设备 B 敲击 5 次 | 设备 B：敲击=65 | | ⬜ |
| 7 | 在设备 A 刷新 | 设备 A：敲击=65 | | ⬜ |

---

## 🐛 常见问题测试

### 问题 1: 数据丢失
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 敲击 100 次 | 数据保存 | | ⬜ |
| 2 | 清除浏览器缓存 | 缓存清除 | | ⬜ |
| 3 | 重新打开扩展 | 数据仍然存在（Chrome Storage 不受影响） | | ⬜ |

### 问题 2: 时区问题
**优先级**: P1

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 在北京时间 23:50 敲击 | 记录为今日 | | ⬜ |
| 2 | 等待到 00:10 | 跨日 | | ⬜ |
| 3 | 再次敲击 | 记录为新的一天，今日敲击重置 | | ⬜ |

### 问题 3: 并发敲击
**优先级**: P1

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 同时打开 2 个 Popup 窗口 | 两个窗口都打开 | | ⬜ |
| 2 | 在窗口 1 敲击 5 次 | 窗口 1 数据更新 | | ⬜ |
| 3 | 在窗口 2 敲击 3 次 | 窗口 2 数据更新 | | ⬜ |
| 4 | 关闭两个窗口 | 窗口关闭 | | ⬜ |
| 5 | 重新打开 Popup | 总敲击次数 = 8（正确累加） | | ⬜ |

---

## 📱 性能测试

### 测试用例

#### TC-PERF-001: 页面加载速度
**优先级**: P1

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Popup | 页面在 500ms 内加载完成 | | ⬜ |
| 2 | 打开 Options | 页面在 1s 内加载完成 | | ⬜ |

#### TC-PERF-002: 敲击响应速度
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 点击木鱼 | 动画在 100ms 内开始 | | ⬜ |
| 2 | 观察数据更新 | 数据在 100ms 内更新 | | ⬜ |

#### TC-PERF-003: 大数据量性能
**优先级**: P1

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 敲击 1000 次 | 页面不卡顿 | | ⬜ |
| 2 | 添加 20 个联系人 | 列表渲染流畅 | | ⬜ |
| 3 | 打开 Popup | 加载速度正常 | | ⬜ |

#### TC-PERF-004: 内存占用
**优先级**: P1

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开 Chrome 任务管理器 | 任务管理器打开 | | ⬜ |
| 2 | 查看扩展内存占用 | < 50MB | | ⬜ |
| 3 | 敲击 100 次 | 内存增长 < 10MB | | ⬜ |

---

## 🔒 安全测试

### 测试用例

#### TC-SEC-001: 数据隔离
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 用户 A 登录 | 登录成功 | | ⬜ |
| 2 | 用户 A 敲击 50 次 | 数据保存 | | ⬜ |
| 3 | 退出登录 | 退出成功 | | ⬜ |
| 4 | 用户 B 登录 | 登录成功 | | ⬜ |
| 5 | 检查用户 B 数据 | 数据为空（不包含用户 A 数据） | | ⬜ |

#### TC-SEC-002: Firestore 权限
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 用户 A 登录 | 登录成功 | | ⬜ |
| 2 | 尝试读取用户 B 的数据 | 权限拒绝错误 | | ⬜ |
| 3 | 尝试修改用户 B 的数据 | 权限拒绝错误 | | ⬜ |

#### TC-SEC-003: 敏感信息保护
**优先级**: P1

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 打开开发者工具 | 工具打开 | | ⬜ |
| 2 | 检查 Console | 无敏感信息泄露 | | ⬜ |
| 3 | 检查 Network | 无明文密码传输 | | ⬜ |
| 4 | 检查 Storage | 无明文敏感信息 | | ⬜ |

---

## 🌐 浏览器兼容性测试

### 测试浏览器
- Chrome 88+
- Edge 88+
- Brave（基于 Chromium）

### 测试用例

#### TC-COMPAT-001: Chrome 浏览器
**优先级**: P0

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 在 Chrome 中安装扩展 | 安装成功 | | ⬜ |
| 2 | 测试所有核心功能 | 功能正常 | | ⬜ |
| 3 | 检查样式显示 | 样式正常 | | ⬜ |

#### TC-COMPAT-002: Edge 浏览器
**优先级**: P1

| 步骤 | 操作 | 预期结果 | 实际结果 | 状态 |
|------|------|----------|----------|------|
| 1 | 在 Edge 中安装扩展 | 安装成功 | | ⬜ |
| 2 | 测试所有核心功能 | 功能正常 | | ⬜ |
| 3 | 检查样式显示 | 样式正常 | | ⬜ |

---

## 📝 测试工具和技巧

### 开发者工具使用

#### 1. 查看 Chrome Storage
```javascript
// 在 Console 中执行
chrome.storage.local.get(null, (data) => {
  console.log('All data:', data);
});
```

#### 2. 清空所有数据
```javascript
// 在 Console 中执行
chrome.storage.local.clear(() => {
  console.log('Data cleared');
  location.reload();
});
```

#### 3. 修改数据进行测试
```javascript
// 设置特定的 HP 值
chrome.storage.local.set({
  userData: {
    hp: 50,
    totalKnocks: 100,
    merit: 200,
    // ... 其他字段
  }
}, () => {
  console.log('Data updated');
  location.reload();
});
```

#### 4. 模拟时间变化
```javascript
// 修改最后敲击时间到 3 天前
chrome.storage.local.get('userData', (result) => {
  const userData = result.userData;
  const threeDaysAgo = Date.now() - (3 * 24 * 60 * 60 * 1000);
  userData.lastKnockTime = threeDaysAgo;
  chrome.storage.local.set({ userData }, () => {
    console.log('Time updated');
    location.reload();
  });
});
```

#### 5. 查看 Firestore 数据
1. 打开 [Firebase Console](https://console.firebase.google.com/)
2. 选择项目
3. 进入 Firestore Database
4. 查看各个集合的数据

#### 6. 触发手动同步
```javascript
// 在 Console 中执行
chrome.runtime.sendMessage({ type: 'SYNC_NOW' }, (response) => {
  console.log('Sync result:', response);
});
```

### 测试数据准备

#### 快速达到里程碑
```javascript
// 设置总敲击次数为 99（下次敲击达到 100）
chrome.storage.local.get('userData', (result) => {
  const userData = result.userData;
  userData.totalKnocks = 99;
  chrome.storage.local.set({ userData }, () => {
    console.log('Ready for milestone');
    location.reload();
  });
});
```

#### 设置多个联系人
```javascript
// 添加测试联系人
const testContacts = {
  contacts: [
    { id: '1', name: '张三', email: 'test1@example.com', relationship: '家人', priority: 1 },
    { id: '2', name: '李四', email: 'test2@example.com', relationship: '朋友', priority: 2 },
    { id: '3', name: '王五', email: 'test3@example.com', relationship: '同事', priority: 3 },
  ],
  version: 1,
};

chrome.storage.local.set({ emergencyContacts: testContacts }, () => {
  console.log('Test contacts added');
  location.reload();
});
```

---

## ✅ 测试报告模板

### 测试执行记录

**测试人员**: ___________  
**测试日期**: ___________  
**测试版本**: v1.0.0  
**测试环境**: Chrome ___ / Edge ___

### 测试结果统计

| 模块 | 总用例数 | 通过 | 失败 | 阻塞 | 通过率 |
|------|---------|------|------|------|--------|
| M1: 敲木鱼 | 8 | | | | |
| M2: 功德值 | 7 | | | | |
| M3: 生命值 | 8 | | | | |
| M4: 数据可视化 | 5 | | | | |
| M5: 死亡通知 | 6 | | | | |
| M6: 国际化 | 5 | | | | |
| M7: 认证同步 | 10 | | | | |
| 集成测试 | 3 | | | | |
| 性能测试 | 4 | | | | |
| 安全测试 | 3 | | | | |
| **总计** | **59** | | | | |

### 缺陷列表

| ID | 模块 | 严重程度 | 描述 | 状态 |
|----|------|---------|------|------|
| BUG-001 | | P0/P1/P2 | | 待修复/已修复 |
| BUG-002 | | | | |

**严重程度说明**:
- P0: 阻塞性缺陷，核心功能无法使用
- P1: 严重缺陷，重要功能受影响
- P2: 一般缺陷，不影响主要功能

### 测试结论

- [ ] 所有 P0 用例通过
- [ ] 所有 P1 用例通过（或有合理说明）
- [ ] 无 P0 级别缺陷
- [ ] P1 级别缺陷已记录并计划修复

**总体评价**: ___________

**建议**: ___________

---

## 📚 附录

### A. 测试数据参考

#### 功德值计算示例
```
场景 1: 首次敲击
- 基础功德: 1
- 首次加成: 5
- 总计: 6

场景 2: 连击 3 次（3秒内）
- 第 1 次: 1 + 0(连击) = 1
- 第 2 次: 1 + 1(连击) = 2
- 第 3 次: 1 + 2(连击) = 3
- 总计: 6

场景 3: 达到 10 次里程碑
- 基础功德: 1
- 里程碑奖励: 10
- 总计: 11
```

#### HP 计算示例
```
场景 1: 每日首次敲击
- 当前 HP: 50
- 奖励: +10
- 结果: 60

场景 2: 3 天未敲击
- 当前 HP: 100
- 惩罚: -10 × 3 = -30
- 结果: 70

场景 3: HP 归零后恢复
- 当前 HP: 0
- 敲击奖励: +10
- 结果: 10
```

### B. 常见问题排查

#### 问题 1: 数据不同步
**排查步骤**:
1. 检查网络连接
2. 检查登录状态
3. 查看 Console 错误日志
4. 检查 Firestore Security Rules
5. 手动触发同步

#### 问题 2: 翻译显示错误
**排查步骤**:
1. 检查语言设置
2. 清除缓存重新加载
3. 检查翻译文件是否存在
4. 查看 Console 是否有错误

#### 问题 3: 动画卡顿
**排查步骤**:
1. 检查 CPU 使用率
2. 关闭其他标签页
3. 检查是否有内存泄漏
4. 更新浏览器到最新版本

---

## 🎯 测试优先级建议

### 第一轮测试（核心功能）
1. M1: 敲木鱼核心功能（所有 P0 用例）
2. M2: 功德值系统（TC-M2-001, 002, 005）
3. M3: 生命值系统（TC-M3-001, 002, 005）
4. M7: 认证与同步（TC-M7-001, 003, 004）

### 第二轮测试（重要功能）
1. M4: 数据可视化（所有用例）
2. M5: 死亡通知系统（所有用例）
3. M6: 国际化（所有用例）
4. 集成测试场景 1-3

### 第三轮测试（增强功能）
1. 性能测试
2. 安全测试
3. 浏览器兼容性测试
4. 所有 P1 用例

---

**文档版本**: v1.0.0  
**最后更新**: 2026-01-22  
**维护者**: 项目团队

如有问题或建议，请联系项目负责人或在 GitHub Issues 中提出。

